<div class="curriculum-plan-editor"
     data-planid="{{plan.id}}"
     data-readonly="{{readonly}}">

    <h2 class="mb-3">
        {{plan.name}}
        {{#readonly}}
            <span class="badge bg-secondary">
                {{#str}} readonly, local_curriculum {{/str}}
            </span>
        {{/readonly}}
    </h2>

    <section class="areas-container d-flex flex-wrap gap-3" id="areas-sortable">
        {{#areas}}
        <article class="area-card card flex-fill d-flex flex-column"
            style="min-width: 400px; max-width: 500px;"
            data-areaid="{{id}}"
            data-sortorder="{{sortorder}}"
            data-virtual="{{is_virtual}}">

            <header class="card-header">

                <div class="d-flex align-items-center gap-2 justify-content-between">
                    <span>
                    <strong>{{name}}</strong>
                    </span>
                    {{^readonly}}
                    {{^is_virtual}}
                    {{#id}}
                    <div class="area-actions">
                        <a href="{{editurl}}" class="edit-area" data-areaid="{{id}}">
                            {{#pix}}
                                t/edit, core
                            {{/pix}}
                        </a>
                        <a href="#" class="delete-area" data-areaid="{{id}}">
                            {{#pix}}
                                t/delete, core
                            {{/pix}}
                        </a>
                        <div class="area-order-controls btn-group btn-group-sm">
                        <button type="button"
                                class="btn btn-outline-secondary move-area-up"
                                aria-label="{{#str}} moveup {{/str}}">
                            ↑
                        </button>
                        <button type="button"
                                class="btn btn-outline-secondary move-area-down"
                                aria-label="{{#str}} movedown {{/str}}">
                            ↓
                        </button>
                    </div>
                    </div>
                    {{/id}}
                    {{/is_virtual}}
                    {{/readonly}}
                </div>
            </header>

            <ul class="list-group list-group-flush flex-grow-1 subjects"
                data-areaid="{{id}}">

                {{#subjects}}
                <li class="list-group-item subject-item d-flex justify-content-between align-items-center"
                    data-subjectid="{{id}}"
                    data-sortorder="{{sortorder}}">

                    <span class="d-flex align-items-center gap-2">
                        {{name}}
                        <small class="text-muted">
                            ({{ihs}} hora(s) semanal(es))
                        </small>
                    </span>

                    {{^readonly}}
                    <span class="subject-actions">
                        <a href="#" class="edit-subject" 
                        data-subjectid="{{id}}">
                            {{#pix}}
                                t/edit, core
                            {{/pix}}
                        </a>
                        <a href="#" class="delete-subject" data-subjectid="{{id}}">
                            {{#pix}}
                                t/delete, core
                            {{/pix}}
                        </a>
                        <div class="subject-order-controls btn-group btn-group-sm">
                        <button type="button"
                                class="btn btn-outline-secondary move-subject-up"
                                aria-label="{{#str}} moveup {{/str}}">
                            ↑
                        </button>
                        <button type="button"
                                class="btn btn-outline-secondary move-subject-down"
                                aria-label="{{#str}} movedown {{/str}}">
                            ↓
                        </button>
                    </div>
                    </span>
                    {{/readonly}}
                </li>
                {{/subjects}}

                {{^subjects}}
                <li class="list-group-item text-muted"
                    style="margin:auto">
                    {{#str}} nosubjects, local_curriculum {{/str}}
                </li>
                {{/subjects}}

            </ul>
            <footer class="card-footer text-center">
                <a href="#" class="btn btn-sm btn-outline-primary add-subject" data-areaid="{{id}}">
                    {{#str}} addsubject, local_curriculum {{/str}}
                </a>
            </footer>
        </article>
        {{/areas}}

    </section>

    {{^readonly}}
    <div class="mt-4">
        <a href="#" class="btn btn-outline-primary add-area">
                    {{#str}} addarea, local_curriculum {{/str}}
        </a>
        <button class="btn btn-primary" id="save-structure">
            {{#str}} savestructure, local_curriculum {{/str}}
        </button>
    </div>
    {{/readonly}}

    {{#js}}
        require(['local_curriculum/plan_editor'], function(editor) {
            editor.init({
                planid: {{plan.id}},
                readonly: {{readonly}}
            });
        });
    {{/js}}

</div>
